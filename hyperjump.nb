(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     13241,        369]
NotebookOptionsPosition[     11852,        337]
NotebookOutlinePosition[     12302,        354]
CellTagsIndexPosition[     12259,        351]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"next", "[", "l_List", "]"}], ":=", 
   RowBox[{
    RowBox[{"Mod", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"l", "[", 
          RowBox[{"[", 
           RowBox[{"-", "2"}], "]"}], "]"}], 
         RowBox[{"l", "[", 
          RowBox[{"[", 
           RowBox[{"-", "1"}], "]"}], "]"}]}], ",", 
        RowBox[{
         RowBox[{"l", "[", 
          RowBox[{"[", 
           RowBox[{"-", "2"}], "]"}], "]"}], "+", 
         RowBox[{"l", "[", 
          RowBox[{"[", 
           RowBox[{"-", "1"}], "]"}], "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"With", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"d", "=", 
            RowBox[{
             RowBox[{"l", "[", 
              RowBox[{"[", 
               RowBox[{"-", "2"}], "]"}], "]"}], "-", 
             RowBox[{"l", "[", 
              RowBox[{"[", 
               RowBox[{"-", "1"}], "]"}], "]"}]}]}], "}"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"Which", "[", 
           RowBox[{
            RowBox[{"d", ">", "0"}], ",", "d", ",", 
            RowBox[{
             RowBox[{"Length", "@", "l"}], ">", "2"}], ",", 
            RowBox[{"10", "+", "d"}], ",", "True", ",", "Nothing"}], "]"}]}], 
         "]"}], ",", 
        RowBox[{"Select", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"FromDigits", "/@", 
              RowBox[{"With", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"i", "=", "#"}], "}"}], ",", 
                RowBox[{
                 RowBox[{
                  RowBox[{"i", "[", 
                   RowBox[{"[", 
                    RowBox[{"#", ";;", 
                    RowBox[{"-", "2"}]}], "]"}], "]"}], "&"}], "/@", 
                 RowBox[{"Range", "[", 
                  RowBox[{
                   RowBox[{"Length", "@", "i"}], "-", "1"}], "]"}]}]}], 
               "]"}]}], "&"}], "\[IndentingNewLine]", "@", "l"}], "/", 
           RowBox[{"l", "[", 
            RowBox[{"[", 
             RowBox[{"-", "1"}], "]"}], "]"}]}], ",", "IntegerQ"}], "]"}]}], 
       "}"}], ",", "10"}], "]"}], "//", "Flatten"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"validate", "[", "list_List", "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{"And", "@@", 
     RowBox[{"With", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"l", "=", "#"}], "}"}], ",", 
       RowBox[{"MapIndexed", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"MemberQ", "[", 
           RowBox[{"#", ",", 
            RowBox[{"l", "[", 
             RowBox[{"[", 
              RowBox[{"2", "+", 
               RowBox[{"#2", "[", 
                RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "]"}]}], "]"}], 
          "&"}], ",", 
         RowBox[{"Map", "[", 
          RowBox[{"next", ",", 
           RowBox[{
            RowBox[{
             RowBox[{"l", "[", 
              RowBox[{"[", 
               RowBox[{";;", "#"}], "]"}], "]"}], "&"}], "/@", 
            RowBox[{"Range", "[", 
             RowBox[{"2", ",", 
              RowBox[{
               RowBox[{"Length", "@", "l"}], "-", "1"}]}], "]"}]}]}], "]"}]}],
         "]"}]}], "]"}]}], "&"}], "[", 
   RowBox[{"list", "~", "Join", "~", 
    RowBox[{"{", "9", "}"}]}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.890042489474985*^9, 3.8900424975017223`*^9}, {
   3.8900425445448065`*^9, 3.890042679315159*^9}, {3.8900428307035666`*^9, 
   3.890042924018737*^9}, {3.8900431999923425`*^9, 3.8900432212183685`*^9}, {
   3.89004326017704*^9, 3.890043261446064*^9}, {3.890043892460617*^9, 
   3.8900439310357103`*^9}, {3.8900439723284407`*^9, 3.890044022235055*^9}, 
   3.890044101756198*^9, 3.890044262450203*^9, {3.8900443902987905`*^9, 
   3.890044488974431*^9}, {3.8900446338309784`*^9, 3.8900447118167105`*^9}, {
   3.8900447744165316`*^9, 3.8900447907165813`*^9}, {3.890046090424898*^9, 
   3.890046095796989*^9}, {3.890046816801727*^9, 3.89004682429256*^9}},
 CellLabel->"In[6]:=",ExpressionUUID->"5f4ec852-c09b-4813-931c-1ecbb55cfba9"],

Cell[BoxData[
 RowBox[{
  RowBox[{"hyperjump", "[", 
   RowBox[{"l_List", ",", "n_Integer"}], "]"}], ":=", 
  RowBox[{"Select", "[", 
   RowBox[{
    RowBox[{"DeleteDuplicates", "@", 
     RowBox[{"Permutations", "[", 
      RowBox[{"l", ",", 
       RowBox[{"{", "n", "}"}]}], "]"}]}], ",", "validate"}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.890046668297248*^9, 3.8900466998238745`*^9}},
 CellLabel->"In[8]:=",ExpressionUUID->"4fa95406-c971-4243-85a2-cab44a2f954d"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"hyperjump", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
    "3", ",", "3", ",", "3", ",", "1", ",", "7", ",", "7", ",", "8", ",", 
     "6"}], "}"}], ",", "5"}], "]"}]], "Input",
 CellChangeTimes->{{3.8900466032894745`*^9, 3.8900466393585186`*^9}, {
  3.8900467465058675`*^9, 3.890046753428608*^9}},
 CellLabel->"In[9]:=",ExpressionUUID->"4d30bfa6-df5f-437f-8ea6-52f97ef03a24"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"3", ",", "3", ",", "6", ",", "7", ",", "8"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "1", ",", "3", ",", "3", ",", "6"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "7", ",", "1", ",", "7", ",", "3"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "7", ",", "1", ",", "7", ",", "8"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "7", ",", "1", ",", "6", ",", "7"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "8", ",", "1", ",", "7", ",", "7"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "3", ",", "3", ",", "6", ",", "7"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "7", ",", "8", ",", "6", ",", "3"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"7", ",", "3", ",", "1", ",", "3", ",", "3"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"7", ",", "1", ",", "8", ",", "3", ",", "6"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"7", ",", "1", ",", "6", ",", "7", ",", "3"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"7", ",", "8", ",", "6", ",", "3", ",", "3"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"7", ",", "6", ",", "3", ",", "8", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"7", ",", "6", ",", "1", ",", "7", ",", "8"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"8", ",", "3", ",", "1", ",", "3", ",", "3"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"8", ",", "7", ",", "1", ",", "6", ",", "7"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"8", ",", "7", ",", "6", ",", "3", ",", "3"}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.8900465915440083`*^9, 3.8900466407093353`*^9}, 
   3.8900467548710318`*^9, 3.890046836773261*^9},
 CellLabel->"Out[9]=",ExpressionUUID->"4040d4e2-96df-49cf-9315-f92ba16014df"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"hyperjump", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
    "3", ",", "3", ",", "3", ",", "1", ",", "7", ",", "7", ",", "8", ",", 
     "6"}], "}"}], ",", "6"}], "]"}]], "Input",
 CellChangeTimes->{3.890046762733181*^9},
 CellLabel->"In[10]:=",ExpressionUUID->"8404d187-e236-430a-81a2-6ff1930fa16e"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"3", ",", "1", ",", "3", ",", "3", ",", "6", ",", "7"}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "7", ",", "1", ",", "8", ",", "3", ",", "6"}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "7", ",", "1", ",", "6", ",", "7", ",", "3"}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "3", ",", "3", ",", "6", ",", "7", ",", "8"}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "7", ",", "8", ",", "6", ",", "3", ",", "3"}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{"7", ",", "3", ",", "1", ",", "3", ",", "3", ",", "6"}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{"7", ",", "1", ",", "7", ",", "8", ",", "6", ",", "3"}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{"7", ",", "1", ",", "8", ",", "3", ",", "6", ",", "7"}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{"7", ",", "7", ",", "1", ",", "8", ",", "3", ",", "6"}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{"8", ",", "3", ",", "1", ",", "3", ",", "3", ",", "6"}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{"8", ",", "7", ",", "1", ",", "6", ",", "7", ",", "3"}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{"6", ",", "3", ",", "8", ",", "1", ",", "7", ",", "7"}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{"6", ",", "7", ",", "3", ",", "1", ",", "3", ",", "3"}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{3.890046763261647*^9, 3.890046842764526*^9},
 CellLabel->"Out[10]=",ExpressionUUID->"68fa357a-f8ba-4ddd-a5f1-4c4447021a1c"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"hyperjump", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
    "3", ",", "3", ",", "3", ",", "1", ",", "7", ",", "7", ",", "8", ",", 
     "6"}], "}"}], ",", "7"}], "]"}]], "Input",
 CellChangeTimes->{
  3.890046762733181*^9, {3.890046890977631*^9, 3.890046891044067*^9}},
 CellLabel->"In[11]:=",ExpressionUUID->"9f9838a2-463e-45d8-9a1e-591d710d4009"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"3", ",", "1", ",", "3", ",", "3", ",", "6", ",", "7", ",", "8"}],
     "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "7", ",", "1", ",", "7", ",", "8", ",", "6", ",", "3"}],
     "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "7", ",", "1", ",", "8", ",", "3", ",", "6", ",", "7"}],
     "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"7", ",", "3", ",", "1", ",", "3", ",", "3", ",", "6", ",", "7"}],
     "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"7", ",", "1", ",", "7", ",", "8", ",", "6", ",", "3", ",", "3"}],
     "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"7", ",", "1", ",", "8", ",", "3", ",", "6", ",", "7", ",", "3"}],
     "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"8", ",", "3", ",", "1", ",", "3", ",", "3", ",", "6", ",", "7"}],
     "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"8", ",", "3", ",", "1", ",", "3", ",", "7", ",", "6", ",", "3"}],
     "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.8900468926523547`*^9},
 CellLabel->"Out[11]=",ExpressionUUID->"2ccb0463-5bb3-42cc-939b-1b2f781bcbc4"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"hyperjump", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
    "3", ",", "3", ",", "3", ",", "1", ",", "7", ",", "7", ",", "8", ",", 
     "6"}], "}"}], ",", "8"}], "]"}]], "Input",
 CellChangeTimes->{
  3.890046762733181*^9, {3.890046890977631*^9, 3.890046891044067*^9}, {
   3.8900469482124386`*^9, 3.8900469482646036`*^9}},
 CellLabel->"In[12]:=",ExpressionUUID->"1f3df825-492a-46a7-8555-3f27e749cc68"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
    "3", ",", "7", ",", "1", ",", "7", ",", "8", ",", "6", ",", "3", ",", 
     "3"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "3", ",", "7", ",", "1", ",", "8", ",", "3", ",", "6", ",", "7", ",", 
     "3"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "7", ",", "3", ",", "1", ",", "3", ",", "3", ",", "6", ",", "7", ",", 
     "8"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.8900469498095164`*^9},
 CellLabel->"Out[12]=",ExpressionUUID->"d33738bd-6ef2-4345-9212-95b4e5912e42"]
}, Open  ]]
},
WindowSize->{643, 606},
WindowMargins->{{416, Automatic}, {67, Automatic}},
TaggingRules->Association["TryRealOnly" -> False],
FrontEndVersion->"12.3 for Microsoft Windows (64-bit) (June 19, 2021)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"113fa407-58d4-40ac-8574-58d6c09c2212"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 4164, 110, 170, "Input",ExpressionUUID->"5f4ec852-c09b-4813-931c-1ecbb55cfba9"],
Cell[4725, 132, 474, 12, 50, "Input",ExpressionUUID->"4fa95406-c971-4243-85a2-cab44a2f954d"],
Cell[CellGroupData[{
Cell[5224, 148, 404, 9, 29, "Input",ExpressionUUID->"4d30bfa6-df5f-437f-8ea6-52f97ef03a24"],
Cell[5631, 159, 1767, 40, 114, "Output",ExpressionUUID->"4040d4e2-96df-49cf-9315-f92ba16014df"]
}, Open  ]],
Cell[CellGroupData[{
Cell[7435, 204, 326, 8, 29, "Input",ExpressionUUID->"8404d187-e236-430a-81a2-6ff1930fa16e"],
Cell[7764, 214, 1534, 43, 94, "Output",ExpressionUUID->"68fa357a-f8ba-4ddd-a5f1-4c4447021a1c"]
}, Open  ]],
Cell[CellGroupData[{
Cell[9335, 262, 375, 9, 29, "Input",ExpressionUUID->"9f9838a2-463e-45d8-9a1e-591d710d4009"],
Cell[9713, 273, 1088, 28, 74, "Output",ExpressionUUID->"2ccb0463-5bb3-42cc-939b-1b2f781bcbc4"]
}, Open  ]],
Cell[CellGroupData[{
Cell[10838, 306, 429, 10, 29, "Input",ExpressionUUID->"1f3df825-492a-46a7-8555-3f27e749cc68"],
Cell[11270, 318, 566, 16, 33, "Output",ExpressionUUID->"d33738bd-6ef2-4345-9212-95b4e5912e42"]
}, Open  ]]
}
]
*)

(* End of internal cache information *)

